# NRL Finder

The nrl_finder function takes a .bed file and extracts lengths of each read. It then computes a histogram of read lengths and applies a low-pass filter to this data, so that local minima and maxima (i.e. NRLs) can be computed. The main execution script (bin/nrl.py) is written in Python 3. A bash shell script nrl_finder is also given for command line calls.

This code is provided free of charge and as-is. Reproduce, redistribute or modify it as you see fit. Use at your own risk.

## Getting Started

### Dependencies

1. Python (written in Python 3, compatible with Python 2)
2. [Numpy](https://www.numpy.org/) 1.15.2 (or newer)
3. [Scipy](https://www.scipy.org/) 1.3.0 (or newer)
4. [Matplotlib](https://matplotlib.org/) 3.1.0 (or newer)

### Installing

1. Clone nrl_finder package from GitHub

```
$ git clone https://github.com/tommyjohn21/nrl_finder.git
```

2. Add nrl_finder utility to command line path

```
$ export PATH="$PATH:/path/to/nrl_finder"
```

Alternatively, the bin/nrl.py utility can be imported into Python:

```
>>> import sys
>>> sys.path.append("/path/to/nrl_finder/bin")
>>> import nrl
```

3. Verify install
Calling nrl_finder without arguments returns usage. See -h flag for additional information regarding input arguments.

```
$ nrl_finder
usage:     nrl_finder.sh -b </path/to/bedfile.bed> [-h] [-o <out_format>] 
                [-y <offset>] [-f <freq_cutoff>] [-t <count_thr>]
                
Use -h (help) flag for additional information.
```

Or, from Python:

```
>>> help(nrl.finder)
```

## Demonstration

A single .bed file (/path/to/nrl_finder/demo/wt.bed) is included for demonstration purposes.

For shell-scripting:

```
$ nrl_finder -b /path/to/nrl_finder/demo/wt.bed
194    399    578    773    857    981
```

For Python:

```
>>> nrl.finder(bedfile="/path/to/nrl_finder/demo/wt.bed")
array([194, 399, 578, 773, 857, 981])
```

For both cases, a figure can be generated (printed to current directory) by changing the output format. 

For instance, the commands:

```
$ nrl_finder -b /path/to/nrl_finder/demo/wt.bed -o figure
```
and
```
>>> nrl.finder(bedfile="/path/to/nrl_finder/demo/wt.bed",out_format="figure")
```

generate:

![Figure generated by /demo/wt.bed](https://github.com/tommyjohn21/nrl_finder/demo/wt.png)

Additional plotted outputs (local minima and area under the curve) can also be queried as given in the documentation.

## Development

This code was developed and deployed by Tommy Wilson.

